2025-03-01 23:35:28,933 [INFO] 🚀 データ取得を開始
2025-03-01 23:35:28,933 [DEBUG] スクリプト開始
2025-03-01 23:35:28,933 [DEBUG] API_KEY: WGV3FY8PM9SKEZTK
2025-03-01 23:35:29,671 [DEBUG] API Response Status: 200
2025-03-01 23:35:29,672 [DEBUG] API Response Content: {
    "Meta Data": {
        "1. Information": "Daily Prices (open, high, low, close) and Volumes",
        "2. Symbol": "NVDA",
        "3. Last Refreshed": "2025-02-28",
        "4. Output Size": "Compact",
        "5. Time Zone": "US/Eastern"
    },
    "Time Series (Daily)": {
        "2025-02-28": {
            "1. open": "118.0200",
            "2. high": "125.0900",
            "3. low": "116.4000",
            "4. close": "124.9200",
            "5. volume": "389091145"
        },
      
2025-03-01 23:35:29,672 [DEBUG] API Request URL: https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=NVDA&apikey=WGV3FY8PM9SKEZTK&outputsize=compact&datatype=json
2025-03-01 23:35:29,688 [INFO] ✅ データ品質チェック OK！
2025-03-01 23:35:29,688 [DEBUG] データベース接続を開始
2025-03-01 23:35:31,310 [ERROR] ❌ データ保存エラー: relation "test_stock_prices" does not exist
LINE 2:         INSERT INTO test_stock_prices (date, open, high, low...
                            ^
Traceback (most recent call last):
  File "/Users/koichi/Library/CloudStorage/GoogleDrive-yoshidome.kouichi@gmail.com/.shortcut-targets-by-id/1YPflACfNCBy1sNnuIrSAGpX5J8mL3Pcn/Google Drive/01.Private/Documents/Alpha_Vantage_project/tests/test_src/test_fetch.py", line 139, in save_to_db
    execute_values(cur, insert_sql, rows)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/koichi/Library/CloudStorage/GoogleDrive-yoshidome.kouichi@gmail.com/.shortcut-targets-by-id/1YPflACfNCBy1sNnuIrSAGpX5J8mL3Pcn/Google Drive/01.Private/Documents/Alpha_Vantage_project/venv/lib/python3.13/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: relation "test_stock_prices" does not exist
LINE 2:         INSERT INTO test_stock_prices (date, open, high, low...
                            ^

2025-03-01 23:35:31,312 [DEBUG] データベース接続を閉じました
2025-03-01 23:35:31,312 [INFO] 🎉 処理完了
2025-03-01 23:39:17,222 [INFO] 🚀 データ取得を開始
2025-03-01 23:39:17,222 [DEBUG] スクリプト開始
2025-03-01 23:39:17,222 [DEBUG] API_KEY: WGV3FY8PM9SKEZTK
2025-03-01 23:39:17,905 [DEBUG] API Response Status: 200
2025-03-01 23:39:17,905 [DEBUG] API Response Content: {
    "Meta Data": {
        "1. Information": "Daily Prices (open, high, low, close) and Volumes",
        "2. Symbol": "NVDA",
        "3. Last Refreshed": "2025-02-28",
        "4. Output Size": "Compact",
        "5. Time Zone": "US/Eastern"
    },
    "Time Series (Daily)": {
        "2025-02-28": {
            "1. open": "118.0200",
            "2. high": "125.0900",
            "3. low": "116.4000",
            "4. close": "124.9200",
            "5. volume": "389091145"
        },
      
2025-03-01 23:39:17,905 [DEBUG] API Request URL: https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=NVDA&apikey=WGV3FY8PM9SKEZTK&outputsize=compact&datatype=json
2025-03-01 23:39:17,929 [INFO] ✅ データ品質チェック OK！
2025-03-01 23:39:17,929 [DEBUG] データベース接続を開始
2025-03-01 23:39:18,045 [ERROR] ❌ データ保存エラー: there is no unique or exclusion constraint matching the ON CONFLICT specification
Traceback (most recent call last):
  File "/Users/koichi/Library/CloudStorage/GoogleDrive-yoshidome.kouichi@gmail.com/.shortcut-targets-by-id/1YPflACfNCBy1sNnuIrSAGpX5J8mL3Pcn/Google Drive/01.Private/Documents/Alpha_Vantage_project/tests/test_src/test_fetch.py", line 139, in save_to_db
    execute_values(cur, insert_sql, rows)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/koichi/Library/CloudStorage/GoogleDrive-yoshidome.kouichi@gmail.com/.shortcut-targets-by-id/1YPflACfNCBy1sNnuIrSAGpX5J8mL3Pcn/Google Drive/01.Private/Documents/Alpha_Vantage_project/venv/lib/python3.13/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidColumnReference: there is no unique or exclusion constraint matching the ON CONFLICT specification

2025-03-01 23:39:18,046 [DEBUG] データベース接続を閉じました
2025-03-01 23:39:18,046 [INFO] 🎉 処理完了
2025-03-01 23:44:42,476 [INFO] 🚀 データ取得を開始
2025-03-01 23:44:42,476 [DEBUG] スクリプト開始
2025-03-01 23:44:42,476 [DEBUG] API_KEY: WGV3FY8PM9SKEZTK
2025-03-01 23:44:43,297 [DEBUG] API Response Status: 200
2025-03-01 23:44:43,298 [DEBUG] API Response Content: {
    "Meta Data": {
        "1. Information": "Daily Prices (open, high, low, close) and Volumes",
        "2. Symbol": "NVDA",
        "3. Last Refreshed": "2025-02-28",
        "4. Output Size": "Compact",
        "5. Time Zone": "US/Eastern"
    },
    "Time Series (Daily)": {
        "2025-02-28": {
            "1. open": "118.0200",
            "2. high": "125.0900",
            "3. low": "116.4000",
            "4. close": "124.9200",
            "5. volume": "389091145"
        },
      
2025-03-01 23:44:43,298 [DEBUG] API Request URL: https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=NVDA&apikey=WGV3FY8PM9SKEZTK&outputsize=compact&datatype=json
2025-03-01 23:44:43,324 [INFO] ✅ データ品質チェック OK！
2025-03-01 23:44:43,324 [DEBUG] データベース接続を開始
2025-03-01 23:44:43,444 [INFO] ✅ 100件のデータを保存しました！
2025-03-01 23:44:43,444 [DEBUG] データベース接続を閉じました
2025-03-01 23:44:43,444 [INFO] 🎉 処理完了
